<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">








  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">

















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.1.1',
    sidebar: {"position":"right","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Why We Hate Cilantro I want to analysis SNP in coding region of olfactory receptor. In 2012, researchers studied SNP correlated with cilantro preference, and they found an SNP rs72921001 influence peo">
<meta name="keywords" content="Bioinformatics,R,Ensembl,biomaRt">
<meta property="og:type" content="article">
<meta property="og:title" content="Access Ensemble Genome Database to BiomaRt of R">
<meta property="og:url" content="https://www.birdlet.github.io/2017/08/16/biomaRt_intro_OR/index.html">
<meta property="og:site_name" content="Life is Worth Living">
<meta property="og:description" content="Why We Hate Cilantro I want to analysis SNP in coding region of olfactory receptor. In 2012, researchers studied SNP correlated with cilantro preference, and they found an SNP rs72921001 influence peo">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-04-23T15:33:30.193Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Access Ensemble Genome Database to BiomaRt of R">
<meta name="twitter:description" content="Why We Hate Cilantro I want to analysis SNP in coding region of olfactory receptor. In 2012, researchers studied SNP correlated with cilantro preference, and they found an SNP rs72921001 influence peo">





  
  
  <link rel="canonical" href="https://www.birdlet.github.io/2017/08/16/biomaRt_intro_OR/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Access Ensemble Genome Database to BiomaRt of R | Life is Worth Living</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Life is Worth Living</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.birdlet.github.io/2017/08/16/biomaRt_intro_OR/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Birdlet">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Life is Worth Living">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Access Ensemble Genome Database to BiomaRt of R

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-08-16 00:35:02" itemprop="dateCreated datePublished" datetime="2017-08-16T00:35:02+08:00">2017-08-16</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-04-23 23:33:30" itemprop="dateModified" datetime="2019-04-23T23:33:30+08:00">2019-04-23</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><strong>Why We Hate Cilantro</strong></p>
<p>I want to analysis SNP in coding region of olfactory receptor. In 2012, researchers studied SNP correlated with cilantro preference, and they found an SNP <strong>rs72921001</strong> influence people’s feeling of cilantro. They said rs72921001 is a frequently accured SNP (an A -&gt; C in DNA sequence) in <strong>OR6A2</strong>, an olfactory receptor.</p>
<p>Resonable, right? I immediately think this could cause an amino acid missense mutation. However, when I searched this SNP in <a href="http://www.ensembl.org/index.html" target="_blank" rel="noopener"><strong>Ensembl</strong></a>, I found it is located at upstream flanking region of OR10A2, and OR6A2 is another gene… Now I think maybe the name is changed during this time, and rs72921001 might influence the expression of OR10A2 in gene level… Umm.</p>
<p>Can I get more imformation of SNP in olfactory receptor? Let’s try by R!</p>
<a id="more"></a>
<h2 id="Ensembl-Database"><a href="#Ensembl-Database" class="headerlink" title="Ensembl Database"></a>Ensembl Database</h2><p>Talking about genome database, <a href="http://www.ensembl.org/index.html" target="_blank" rel="noopener"><strong>Ensembl</strong></a> is the one I prefered and used. I’ll copy the introdution in their main page…</p>
<blockquote>
<p>Ensembl is a genome browser for vertebrate genomes that supports research in comparative genomics, evolution, sequence variation and transcriptional regulation. Ensembl annotate genes, computes multiple alignments, predicts regulatory function and collects disease data. Ensembl tools include BLAST, BLAT, BioMart and the Variant Effect Predictor (VEP) for all supported species.</p>
</blockquote>
<p>How can I access large dataset form Ensembl? Officialy they provide ready-made tools <a href="http://www.ensembl.org/info/docs/tools/index.html" target="_blank" rel="noopener"><strong>here</strong></a>. BioMart here is the most strong tool here. Acctually, what I really want to use here are scripts, so I found this: <a href="https://bioconductor.org/packages/release/bioc/html/biomaRt.html" target="_blank" rel="noopener"><strong>biomaRt</strong></a>. It can access large dataset in BioMart database, including Ensembl, COSMIC, Uniprot, HGNC, Gramene, Wormbase and dbSNP mapped to Ensembl.</p>
<h2 id="Access-Ensembl-Database-by-biomaRt"><a href="#Access-Ensembl-Database-by-biomaRt" class="headerlink" title="Access Ensembl Database by biomaRt"></a>Access Ensembl Database by biomaRt</h2><p>Firstly, install it by <strong>Bioconductor</strong>:<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## try http:// if https:// URLs are not supported</span></span><br><span class="line"><span class="keyword">source</span>(<span class="string">"https://bioconductor.org/biocLite.R"</span>)</span><br><span class="line">biocLite(<span class="string">"biomaRt"</span>)</span><br></pre></td></tr></table></figure></p>
<p>Then import <strong><em>biomaRt</em></strong> and <strong><em>Biostrings</em></strong> (for sequence processing)<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(biomaRt)</span><br><span class="line"><span class="keyword">library</span>(Biostrings)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">setwd(<span class="string">"C:\\Users\\Birdlet\\Desktop\\OR\\OR-Ensembl"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set Ensembl Server</span></span><br><span class="line">ensembl = useEnsembl(biomart = <span class="string">"snp"</span>, dataset = <span class="string">"hsapiens_snp"</span>, mirror = <span class="string">'asia'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># FUN: Fetch OR SNP data</span></span><br><span class="line">fetch_OR &lt;- <span class="keyword">function</span>(OR, OR_name)&#123;</span><br><span class="line">    filename = paste(<span class="string">'data\\'</span>, OR_name, <span class="string">'.csv'</span>, sep = <span class="string">''</span>)</span><br><span class="line">    fetched = getBM(attributes = c(<span class="string">'ensembl_gene_stable_id'</span>, <span class="string">'allele'</span>, <span class="string">'refsnp_id'</span>,</span><br><span class="line">                                   <span class="string">'refsnp_source'</span>, <span class="string">'consequence_type_tv'</span>, <span class="string">'minor_allele_freq'</span>,</span><br><span class="line">                                   <span class="string">'sift_score'</span>, <span class="string">'polyphen_score'</span>,</span><br><span class="line">                                   <span class="string">'ensembl_peptide_allele'</span>, <span class="string">'translation_start'</span>),</span><br><span class="line">                    filters = c(<span class="string">'ensembl_gene'</span>, <span class="string">'minor_allele_freq_second'</span>, <span class="string">'so_mini_parent_name'</span>),</span><br><span class="line">                    values = list(ensembl_gene = OR, freq = <span class="string">'0.001'</span>, </span><br><span class="line">                                  parent_name = <span class="string">'missense_variant'</span>),</span><br><span class="line">                    mart = ensembl)</span><br><span class="line">    write.table(fetched, file = filename, quote = <span class="literal">FALSE</span>, row.names = <span class="literal">FALSE</span>, </span><br><span class="line">              col.names = <span class="literal">FALSE</span>, sep = <span class="string">','</span>, fileEncoding = <span class="string">'utf-8'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Firstly, I use <code>useEnsembl</code> function to initialize the web server, and I give paprameters to choose “SNP” of “Homo Sapiens”. For accelerating connection, I also use mirror in Asia rater than default.</p>
<p>Next, I defined a funtion for later. <code>getBM</code> funtion fetchs data from <strong>Ensembl</strong>, I want data including attributes of _’ensembl_gene_stable_id’, ‘allele’, ‘minor_allele_freq’_, and set _’minor_allele_freq_second’_ larger than <em>‘0.001’</em>. Then I can get genes’ SNP data with MAF larger than 0.1  %.</p>
<p>More details please see manual for <strong>biomRt</strong>. ;P</p>
<h2 id="Access-each-SNP-record-from-Ensembl"><a href="#Access-each-SNP-record-from-Ensembl" class="headerlink" title="Access each SNP record from Ensembl"></a>Access each SNP record from Ensembl</h2><p>After preperation, I can input a file of protein id, and wait for downloading data!</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ENSG00000221858,G/A,rs9655672,dbSNP,missense_variant,<span class="number">0.00858626</span>,<span class="number">0.13</span>,<span class="number">0.361</span>,A/<span class="literal">T</span>,<span class="number">223</span></span><br><span class="line">ENSG00000221858,C/A/<span class="literal">T</span>,rs80128486,dbSNP,missense_variant,<span class="number">0.0081869</span>,<span class="number">0.07</span>,<span class="number">0.1</span>,L/I,<span class="number">279</span></span><br><span class="line">ENSG00000221858,C/A/<span class="literal">T</span>,rs80128486,dbSNP,missense_variant,<span class="number">0.0081869</span>,<span class="number">0.21</span>,<span class="number">0.06</span>,L/<span class="literal">F</span>,<span class="number">279</span></span><br><span class="line">ENSG00000221858,G/A,rs142231743,dbSNP,missense_variant,<span class="number">0.00419329</span>,<span class="number">0.08</span>,<span class="number">0.376</span>,V/I,<span class="number">183</span></span><br><span class="line">ENSG00000221858,<span class="literal">T</span>/A,rs143394460,dbSNP,missense_variant,<span class="number">0.00159744</span>,<span class="number">0</span>,<span class="number">0.986</span>,I/N,<span class="number">91</span></span><br><span class="line">ENSG00000221858,G/A,rs34947817,dbSNP,missense_variant,<span class="number">0.114217</span>,<span class="number">0.3</span>,<span class="number">0.007</span>,S/N,<span class="number">26</span></span><br></pre></td></tr></table></figure>
<h2 id="Update-Later…-Updated"><a href="#Update-Later…-Updated" class="headerlink" title="Update Later… Updated!"></a>Update Later… Updated!</h2><p>You can found more detail about how to use it in <a href="https://bioconductor.org/packages/release/bioc/vignettes/biomaRt/inst/doc/biomaRt.html" target="_blank" rel="noopener">https://bioconductor.org/packages/release/bioc/vignettes/biomaRt/inst/doc/biomaRt.html</a>. Also, you can simply use help in R, it’s really convinient in RStdio.</p>
<p>BTW, I dislike cilantro but now I can accept it… Genes and environments together determine what we are!</p>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Bioinformatics/" rel="tag"># Bioinformatics</a>
          
            <a href="/tags/R/" rel="tag"># R</a>
          
            <a href="/tags/Ensembl/" rel="tag"># Ensembl</a>
          
            <a href="/tags/biomaRt/" rel="tag"># biomaRt</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/08/08/trj_contact_map/" rel="next" title="Use Python to Generate Protein Contact Map of Molecular Dynamics">
                <i class="fa fa-chevron-left"></i> Use Python to Generate Protein Contact Map of Molecular Dynamics
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/09/06/molecular_denovo_design/" rel="prev" title="论文笔记：药物de novo设计与深度增强学习">
                论文笔记：药物de novo设计与深度增强学习 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Birdlet</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">10</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">20</span>
                    <span class="site-state-item-name">tags</span>
                  
                </div>
              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/birdlet" title="GitHub &rarr; https://github.com/birdlet" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Ensembl-Database"><span class="nav-number">1.</span> <span class="nav-text">Ensembl Database</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Access-Ensembl-Database-by-biomaRt"><span class="nav-number">2.</span> <span class="nav-text">Access Ensembl Database by biomaRt</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Access-each-SNP-record-from-Ensembl"><span class="nav-number">3.</span> <span class="nav-text">Access each SNP record from Ensembl</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Update-Later…-Updated"><span class="nav-number">4.</span> <span class="nav-text">Update Later… Updated!</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Birdlet</span>

  

  
</div>









        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.1"></script>

  <script src="/js/motion.js?v=7.1.1"></script>



  
  


  <script src="/js/affix.js?v=7.1.1"></script>

  <script src="/js/schemes/pisces.js?v=7.1.1"></script>



  
  <script src="/js/scrollspy.js?v=7.1.1"></script>
<script src="/js/post-details.js?v=7.1.1"></script>



  


  <script src="/js/next-boot.js?v=7.1.1"></script>


  

  

  

  


  


  




  

  

  
  

  
  

  


  

  

  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>


  

  

  

  

  

  

  

  

</body>
</html>
